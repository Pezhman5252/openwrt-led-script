#!/bin/sh /etc/rc.common

# Internet LED Controller for OpenWRT - Init.d Service
# Version: 7.0 Premium

USE_PROCD=1
START=99
STOP=15

start_service() {
    procd_set_param command /bin/sh "/usr/bin/internet_led_status.sh"
    procd_set_param respawn ${respawn_threshold:-3600} ${respawn_timeout:-5} ${respawn_delay:-5}
    procd_set_param stdout 1
    procd_set_param stderr 1
}

stop_service() {
    # Graceful shutdown handled by script trap
}

status() {
    if [ -f "/tmp/internet_status_cache" ]; then
        echo "Internet LED Controller: Running"
        return 0
    else
        echo "Internet LED Controller: Stopped"
        return 1
    fi
}